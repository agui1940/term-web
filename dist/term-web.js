/*!
 * term-web.js v1.0.6
 * Github: https://github.com/zhw2590582/term-web#readme
 * (c) 2017-2020 Harvey Zack
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Term=e()}(this,function(){"use strict";var O=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t};var _=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};var r=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t},s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(t,e){return t(e={exports:{}},e.exports),e.exports}var n=t(function(e){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(t){return typeof t}:e.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}e.exports=n});var c=function(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?r(t):e},a=t(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(t)}e.exports=n}),h=t(function(n){function i(t,e){return n.exports=i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}n.exports=i});var e=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)},d=t(function(t,e){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return t.constructor?t.constructor.name:null}function a(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:["option"];return h(t,e,n),u(t,e,n),function(o,s,c){var t=l(s),e=l(o);if("object"===t){if("object"!==e)throw new Error("[Type Error]: '".concat(c.join("."),"' require 'object' type, but got '").concat(e,"'"));Object.keys(s).forEach(function(t){var e=o[t],n=s[t],i=c.slice();i.push(t),h(e,n,i),u(e,n,i),a(e,n,i)})}if("array"===t){if("array"!==e)throw new Error("[Type Error]: '".concat(c.join("."),"' require 'array' type, but got '").concat(e,"'"));o.forEach(function(t,e){var n=o[e],i=s[e]||s[0],r=c.slice();r.push(e),h(n,i,r),u(n,i,r),a(n,i,r)})}}(t,e,n),t}function h(t,e,n){if("string"===l(e)){var i=l(t);if(!(-1<e.indexOf("|")?e.split("|").map(function(t){return t.toLowerCase().trim()}).filter(Boolean).some(function(t){return i===t}):e.toLowerCase().trim()===i))throw new Error("[Type Error]: '".concat(n.join("."),"' require '").concat(e,"' type, but got '").concat(i,"'"))}}function u(t,e,n){if("function"===l(e)){var i=e(t,l(t),n);if(!0!==i){var r=l(i);throw"string"===r?new Error(i):"error"===r?i:new Error("[Validator Error]: The scheme for '".concat(n.join("."),"' validator require return true, but got '").concat(i,"'"))}}}var o,l;t.exports=(o=Object.prototype.toString,a.kindOf=l=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var e,n=i(t);if("boolean"===n)return"boolean";if("string"===n)return"string";if("number"===n)return"number";if("symbol"===n)return"symbol";if("function"===n)return"GeneratorFunction"===r(t)?"generatorfunction":"function";if(e=t,Array.isArray?Array.isArray(e):e instanceof Array)return"array";if(t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t))return"buffer";if(function(t){try{if("number"==typeof t.length&&"function"==typeof t.callee)return 1}catch(t){if(-1!==t.message.indexOf("callee"))return 1}}(t))return"arguments";if(t instanceof Date||"function"==typeof t.toDateString&&"function"==typeof t.getDate&&"function"==typeof t.setDate)return"date";if(t instanceof Error||"string"==typeof t.message&&t.constructor&&"number"==typeof t.constructor.stackTraceLimit)return"error";if(t instanceof RegExp||"string"==typeof t.flags&&"boolean"==typeof t.ignoreCase&&"boolean"==typeof t.multiline&&"boolean"==typeof t.global)return"regexp";switch(r(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if("function"==typeof t.throw&&"function"==typeof t.return&&"function"==typeof t.next)return"generator";switch(n=o.call(t)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return n.slice(8,-1).toLowerCase().replace(/\s/g,"")},a)}),u=function(){function t(){_(this,t)}return o(t,[{key:"on",value:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this}},{key:"once",value:function(i,r,o){var s=this;function c(){s.off(i,c);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];r.apply(o,e)}return c._=r,this.on(i,c,o)}},{key:"emit",value:function(t){for(var e=((this.e||(this.e={}))[t]||[]).slice(),n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(var o=0;o<e.length;o+=1)e[o].fn.apply(e[o].ctx,i);return this}},{key:"off",value:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var o=0,s=i.length;o<s;o+=1)i[o].fn!==e&&i[o].fn._!==e&&r.push(i[o]);return r.length?n[t]=r:delete n[t],this}}]),t}(),l=t(function(t){var e,n;e=window,n=function(){function v(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}var n="undefined"==typeof console?function(){}:function(t){console.error(t)},m=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],b=m.length;function x(t){var e=getComputedStyle(t);return e||n("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),e}var w,k=!1;function E(t){if(!function(){if(!k){k=!0;var t=document.createElement("div");t.style.width="200px",t.style.padding="1px 2px 3px 4px",t.style.borderStyle="solid",t.style.borderWidth="1px 2px 3px 4px",t.style.boxSizing="border-box";var e=document.body||document.documentElement;e.appendChild(t);var n=x(t);w=200==Math.round(v(n.width)),E.isBoxSizeOuter=w,e.removeChild(t)}}(),"string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var e=x(t);if("none"==e.display)return function(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<b;e++){t[m[e]]=0}return t}();var n={};n.width=t.offsetWidth,n.height=t.offsetHeight;for(var i=n.isBorderBox="border-box"==e.boxSizing,r=0;r<b;r++){var o=m[r],s=e[o],c=parseFloat(s);n[o]=isNaN(c)?0:c}var a=n.paddingLeft+n.paddingRight,h=n.paddingTop+n.paddingBottom,u=n.marginLeft+n.marginRight,l=n.marginTop+n.marginBottom,d=n.borderLeftWidth+n.borderRightWidth,f=n.borderTopWidth+n.borderBottomWidth,p=i&&w,g=v(e.width);!1!==g&&(n.width=g+(p?0:a+d));var y=v(e.height);return!1!==y&&(n.height=y+(p?0:h+f)),n.innerWidth=n.width-(a+d),n.innerHeight=n.height-(h+f),n.outerWidth=n.width+u,n.outerHeight=n.height+l,n}}return E},t.exports?t.exports=n():e.getSize=n()}),f=t(function(t){var e,n;e="undefined"!=typeof window?window:s,n=function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var n=this._events=this._events||{},i=n[t]=n[t]||[];return-1==i.indexOf(e)&&i.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var n=this._onceEvents=this._onceEvents||{};return(n[t]=n[t]||{})[e]=!0,this}},e.off=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){var i=n.indexOf(e);return-1!=i&&n.splice(i,1),this}},e.emitEvent=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){n=n.slice(0),e=e||[];for(var i=this._onceEvents&&this._onceEvents[t],r=0;r<n.length;r++){var o=n[r];i&&i[o]&&(this.off(t,o),delete i[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t},t.exports?t.exports=n():e.EvEmitter=n()}),p=t(function(t){var e,n;e=window,n=function(r,t){function e(){}var n=e.prototype=Object.create(t.prototype);n.bindStartEvent=function(t){this._bindStartEvent(t,!0)},n.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},n._bindStartEvent=function(t,e){var n=(e=void 0===e||e)?"addEventListener":"removeEventListener",i="mousedown";r.PointerEvent?i="pointerdown":"ontouchstart"in r&&(i="touchstart"),t[n](i,this)},n.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},n.getTouch=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.identifier==this.pointerIdentifier)return n}},n.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},n.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},n.onpointerdown=function(t){this._pointerDown(t,t)},n._pointerDown=function(t,e){t.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},n.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var i={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return n._bindPostStartEvents=function(t){if(t){var e=i[t.type];e.forEach(function(t){r.addEventListener(t,this)},this),this._boundPointerEvents=e}},n._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach(function(t){r.removeEventListener(t,this)},this),delete this._boundPointerEvents)},n.onmousemove=function(t){this._pointerMove(t,t)},n.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},n.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},n._pointerMove=function(t,e){this.pointerMove(t,e)},n.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},n.onmouseup=function(t){this._pointerUp(t,t)},n.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},n.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},n._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},n.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},n._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},n._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},n.pointerDone=function(){},n.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},n.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},n._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},n.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},e.getPointerPoint=function(t){return{x:t.pageX,y:t.pageY}},e},t.exports?t.exports=n(e,f):e.Unipointer=n(e,e.EvEmitter)}),g=t(function(t){var e,n;e=window,n=function(o,t){function e(){}var n=e.prototype=Object.create(t.prototype);n.bindHandles=function(){this._bindHandles(!0)},n.unbindHandles=function(){this._bindHandles(!1)},n._bindHandles=function(t){for(var e=(t=void 0===t||t)?"addEventListener":"removeEventListener",n=t?this._touchActionValue:"",i=0;i<this.handles.length;i++){var r=this.handles[i];this._bindStartEvent(r,t),r[e]("click",this),o.PointerEvent&&(r.style.touchAction=n)}},n._touchActionValue="none",n.pointerDown=function(t,e){this.okayPointerDown(t)&&(this.pointerDownPointer={pageX:e.pageX,pageY:e.pageY},t.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e]))};var r={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},s={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return n.okayPointerDown=function(t){var e=r[t.target.nodeName],n=s[t.target.type],i=!e||n;return i||this._pointerReset(),i},n.pointerDownBlur=function(){var t=document.activeElement;t&&t.blur&&t!=document.body&&t.blur()},n.pointerMove=function(t,e){var n=this._dragPointerMove(t,e);this.emitEvent("pointerMove",[t,e,n]),this._dragMove(t,e,n)},n._dragPointerMove=function(t,e){var n={x:e.pageX-this.pointerDownPointer.pageX,y:e.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(n)&&this._dragStart(t,e),n},n.hasDragStarted=function(t){return 3<Math.abs(t.x)||3<Math.abs(t.y)},n.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e]),this._dragPointerUp(t,e)},n._dragPointerUp=function(t,e){this.isDragging?this._dragEnd(t,e):this._staticClick(t,e)},n._dragStart=function(t,e){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(t,e)},n.dragStart=function(t,e){this.emitEvent("dragStart",[t,e])},n._dragMove=function(t,e,n){this.isDragging&&this.dragMove(t,e,n)},n.dragMove=function(t,e,n){t.preventDefault(),this.emitEvent("dragMove",[t,e,n])},n._dragEnd=function(t,e){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(t,e)},n.dragEnd=function(t,e){this.emitEvent("dragEnd",[t,e])},n.onclick=function(t){this.isPreventingClicks&&t.preventDefault()},n._staticClick=function(t,e){this.isIgnoringMouseUp&&"mouseup"==t.type||(this.staticClick(t,e),"mouseup"!=t.type&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},n.staticClick=function(t,e){this.emitEvent("staticClick",[t,e])},e.getPointerPoint=t.getPointerPoint,e},t.exports?t.exports=n(e,p):e.Unidragger=n(e,e.Unipointer)}),T=t(function(t){var e,n;e=window,n=function(o,a,t){function n(t,e){for(var n in e)t[n]=e[n];return t}var i=o.jQuery;function e(t,e){this.element="string"==typeof t?document.querySelector(t):t,i&&(this.$element=i(this.element)),this.options=n({},this.constructor.defaults),this.option(e),this._create()}var r=e.prototype=Object.create(t.prototype);e.defaults={},r.option=function(t){n(this.options,t)};var s={relative:!0,absolute:!0,fixed:!0};function h(t,e,n){return n=n||"round",e?Math[n](t/e)*e:t}return r._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=n({},this.position);var t=getComputedStyle(this.element);s[t.position]||(this.element.style.position="relative"),this.on("pointerDown",this.onPointerDown),this.on("pointerMove",this.onPointerMove),this.on("pointerUp",this.onPointerUp),this.enable(),this.setHandles()},r.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles()},r.dispatchEvent=function(t,e,n){var i=[e].concat(n);this.emitEvent(t,i),this.dispatchJQueryEvent(t,e,n)},r.dispatchJQueryEvent=function(t,e,n){var i=o.jQuery;if(i&&this.$element){var r=i.Event(e);r.type=t,this.$element.trigger(r,n)}},r._getPosition=function(){var t=getComputedStyle(this.element),e=this._getPositionCoord(t.left,"width"),n=this._getPositionCoord(t.top,"height");this.position.x=isNaN(e)?0:e,this.position.y=isNaN(n)?0:n,this._addTransformPosition(t)},r._getPositionCoord=function(t,e){if(-1==t.indexOf("%"))return parseInt(t,10);var n=a(this.element.parentNode);return n?parseFloat(t)/100*n[e]:0},r._addTransformPosition=function(t){var e=t.transform;if(0===e.indexOf("matrix")){var n=e.split(","),i=0===e.indexOf("matrix3d")?12:4,r=parseInt(n[i],10),o=parseInt(n[1+i],10);this.position.x+=r,this.position.y+=o}},r.onPointerDown=function(t,e){this.element.classList.add("is-pointer-down"),this.dispatchJQueryEvent("pointerDown",t,[e])},r.dragStart=function(t,e){this.isEnabled&&(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.element.classList.add("is-dragging"),this.dispatchEvent("dragStart",t,[e]),this.animate())},r.measureContainment=function(){var t=this.getContainer();if(t){var e=a(this.element),n=a(t),i=this.element.getBoundingClientRect(),r=t.getBoundingClientRect(),o=n.borderLeftWidth+n.borderRightWidth,s=n.borderTopWidth+n.borderBottomWidth,c=this.relativeStartPosition={x:i.left-(r.left+n.borderLeftWidth),y:i.top-(r.top+n.borderTopWidth)};this.containSize={width:n.width-o-c.x-e.width,height:n.height-s-c.y-e.height}}},r.getContainer=function(){var t=this.options.containment;if(t)return t instanceof HTMLElement?t:"string"==typeof t?document.querySelector(t):this.element.parentNode},r.onPointerMove=function(t,e,n){this.dispatchJQueryEvent("pointerMove",t,[e,n])},r.dragMove=function(t,e,n){if(this.isEnabled){var i=n.x,r=n.y,o=this.options.grid,s=o&&o[0],c=o&&o[1];i=h(i,s),r=h(r,c),i=this.containDrag("x",i,s),r=this.containDrag("y",r,c),i="y"==this.options.axis?0:i,r="x"==this.options.axis?0:r,this.position.x=this.startPosition.x+i,this.position.y=this.startPosition.y+r,this.dragPoint.x=i,this.dragPoint.y=r,this.dispatchEvent("dragMove",t,[e,n])}},r.containDrag=function(t,e,n){if(!this.options.containment)return e;var i="x"==t?"width":"height",r=h(-this.relativeStartPosition[t],n,"ceil"),o=this.containSize[i];return o=h(o,n,"floor"),Math.max(r,Math.min(o,e))},r.onPointerUp=function(t,e){this.element.classList.remove("is-pointer-down"),this.dispatchJQueryEvent("pointerUp",t,[e])},r.dragEnd=function(t,e){this.isEnabled&&(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"),this.dispatchEvent("dragEnd",t,[e]))},r.animate=function(){if(this.isDragging){this.positionDrag();var t=this;requestAnimationFrame(function(){t.animate()})}},r.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},r.positionDrag=function(){this.element.style.transform="translate3d( "+this.dragPoint.x+"px, "+this.dragPoint.y+"px, 0)"},r.staticClick=function(t,e){this.dispatchEvent("staticClick",t,[e])},r.setPosition=function(t,e){this.position.x=t,this.position.y=e,this.setLeftTop()},r.enable=function(){this.isEnabled=!0},r.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},r.destroy=function(){this.disable(),this.element.style.transform="",this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},r._init=function(){},i&&i.bridget&&i.bridget("draggabilly",e),e},t.exports?t.exports=n(e,l,g):e.Draggabilly=n(e,e.getSize,e.Unidragger)});function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}var y=function(){function L(n){var t=this;_(this,L),this.destroyEvents=[],this.proxy=this.proxy.bind(this);var e=n.options,i=e.recorder,r=e.draggable,o=e.dragOpt,s=e.pixelRatio,c=n.template,a=c.$container,h=c.$canvas,u=c.$textarea,l=c.$content,d=c.$scrollbar,f=c.$header,p=c.$footer,g=c.$recorder,y=c.$recorderSize,v=c.$recorderDuration,m=c.$recorderBtn,b=c.$resize;this.proxy(document,["click","contextmenu"],function(t){t.composedPath&&-1<t.composedPath().indexOf(l)?(n.isFocus=!0,n.emit("focus")):(n.isFocus=!1,n.emit("blur"))});var x=!1,w=0,k=0,E=0,P=0;this.proxy(b,"mousedown",function(t){x=!0;var e=a.clientWidth,n=a.clientHeight;E=e,P=n,w=t.pageX,k=t.pageY}),this.proxy(document,"mousemove",function(t){if(x){l.style.visibility="hidden";var e=E+t.pageX-w,n=P+t.pageY-k;300<=e&&300<=n&&(a.style.width="".concat(e,"px"),a.style.height="".concat(n,"px"))}}),this.proxy(document,"mouseup",function(){if(x){l.style.visibility="visible";var t=a.clientWidth,e=a.clientHeight;h.width=t*s,h.height=e*s,x=!1,P=E=k=w=0,n.drawer.init()}}),r&&(this.draggie=new T(a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach(function(t){O(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({handle:".term-header"},o)),n.on("destroy",function(){t.draggie.destroy()})),this.proxy(u,"input",function(){n.emit("input",u.value.trim())}),this.proxy(u,"paste",function(){n.emit("input",u.value.trim())}),this.proxy(u,"keydown",function(t){var e=t.keyCode;13===e&&setTimeout(function(){n.emit("enter",u.value.trim()),u.value=""}),[37,38,39,40].includes(e)&&(u.blur(),setTimeout(function(){return u.focus()})),n.emit("keydown",t)}),this.proxy(m,"click",function(){n.recorder.recording?n.recorder.end():n.recorder.start()});var S=!1;this.proxy(l,"scroll",function(){S?n.drawer.renderByTop(l.scrollTop):S=!0}),n.on("scrollTop",function(t){S?S=!1:l.scrollTop=t}),n.on("scrollHeight",function(t){d.style.height="".concat(t,"px")}),n.on("cursor",function(t){var e=t.left,n=t.top;u.style.top="".concat(n,"px"),u.style.left="".concat(e,"px")}),n.on("size",function(t){var e=t.header,n=t.content,i=t.footer;f.style.height="".concat(e,"px"),p.style.height="".concat(i,"px"),l.style.top="".concat(e,"px"),l.style.height="".concat(n,"px")}),n.on("focus",function(){u.focus()}),n.on("start",function(){i&&g.classList.add("recording")}),n.on("recording",function(t){var e=t.size,n=t.duration;i&&(y.innerText="".concat(Math.floor(e/1024)||0,"kb"),v.innerText="".concat(n||0,"s"))}),n.on("end",function(){i&&g.classList.remove("recording")})}return o(L,[{key:"proxy",value:function(e,t,n,i){var r=this,o=3<arguments.length&&void 0!==i?i:{};Array.isArray(t)?t.forEach(function(t){return r.proxy(e,t,n,o)}):(e.addEventListener(t,n,o),this.destroyEvents.push(function(){e.removeEventListener(t,n,o)}))}},{key:"destroy",value:function(){this.destroyEvents.forEach(function(t){return t()})}}]),L}();var v=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")};var m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}},b=t(function(i){function r(t,e,n){return m()?i.exports=r=Reflect.construct:i.exports=r=function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&h(r,n.prototype),r},r.apply(null,arguments)}i.exports=r});function x(i){return function(){var t,e=a(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var n=a(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return c(this,t)}}var w=function(t){e(i,t);var n=x(i);function i(t){var e;return _(this,i),(e=n.call(this,t)).name="TermError",e}return i}(t(function(e){function i(t){var n="function"==typeof Map?new Map:void 0;return e.exports=i=function(t){if(null===t||!v(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return b(t,arguments,a(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),h(e,t)},i(t)}e.exports=i})(Error));function k(t,e){if(!t)throw new w(e);return t}function E(t,e){var n=document.createElement("a");n.style.display="none",n.href=t,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}function C(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}function j(t){return t.replace(/[&<>'"]/g,function(t){return{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"}[t]||t})}var P=Object.freeze({__proto__:null,TermError:w,errorHandle:k,clamp:function(t,e,n){return Math.max(Math.min(t,Math.max(e,n)),Math.min(e,n))},download:E,uuid:C,escape:j,unescape:function(t){return t.replace(/&amp;|&lt;|&gt;|&#39;|&quot;/g,function(t){return{"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&quot;":'"'}[t]||t})}}),S=function(){function f(t){var e=this;_(this,f);var n=(this.term=t).options,i=n.container,r=n.fontFamily,o=n.fontSize,s=n.fontColor,c=n.pixelRatio,a=n.width,h=n.height,u=n.borderRadius,l=n.boxShadow,d=n.recorder;this.$container=i,"string"==typeof t.options.container&&(this.$container=document.querySelector(t.options.container)),k(t.constructor.instances.every(function(t){return t.template.$container!==e.$container}),"Cannot mount multiple instances on the same dom element, please destroy the previous instance first."),this.$container.classList.add("term-container"),this.$container.style.width="".concat(a,"px"),this.$container.style.height="".concat(h,"px"),this.$canvas=document.createElement("canvas"),this.$canvas.classList.add("term-canvas"),this.$canvas.width=a*c,this.$canvas.height=h*c,this.$container.appendChild(this.$canvas),this.$header=document.createElement("div"),this.$header.classList.add("term-header"),this.$container.appendChild(this.$header),this.$content=document.createElement("div"),this.$content.classList.add("term-content"),this.$container.appendChild(this.$content),this.$scrollbar=document.createElement("div"),this.$scrollbar.classList.add("term-scrollbar"),this.$scrollbar.style.height="0",this.$content.appendChild(this.$scrollbar),this.$footer=document.createElement("div"),this.$footer.classList.add("term-footer"),this.$container.appendChild(this.$footer),this.$resize=document.createElement("div"),this.$resize.classList.add("term-resize"),this.$footer.appendChild(this.$resize),this.$textarea=document.createElement("textarea"),this.$textarea.classList.add("term-textarea"),this.$container.appendChild(this.$textarea),d&&(this.$recorder=document.createElement("div"),this.$recorder.classList.add("term-recorder"),this.$recorder.innerHTML='<div class="term-recorder-size"></div><div class="term-recorder-duration"></div><div class="term-recorder-btn"></div> \n            ',this.$recorderSize=this.$recorder.querySelector(".term-recorder-size"),this.$recorderDuration=this.$recorder.querySelector(".term-recorder-duration"),this.$recorderBtn=this.$recorder.querySelector(".term-recorder-btn"),this.$header.appendChild(this.$recorder)),document.getElementById("term-ui-style")||(this.$style=document.createElement("style"),this.$style.id="term-ui-style",this.$style.textContent=[".term-container{font-family:".concat(r,";font-size:").concat(o,"px;color:").concat(s,";position:relative;user-select:none;}"),".term-container ::-webkit-scrollbar{width:5px;}",".term-container ::-webkit-scrollbar-thumb{background-color:#666;border-radius:5px;}",".term-container ::-webkit-scrollbar-thumb:hover{background-color:#ccc;}",".term-canvas{width:100%;height:100%;border-radius:".concat(u,"px;box-shadow:").concat(l,";}"),".term-textarea{position:absolute;width:20px;height:20px;opacity:0;pointer-events:none;}",".term-content{position:absolute;width:100%;right:0;left:0; overflow: auto;}",".term-content:hover{cursor:text}",".term-recorder{display:flex;align-items:center;position:absolute;right:10px;top:10px;}",".term-recorder-size, .term-recorder-duration{display:none;margin-right:10px;}",".term-recorder-btn{height:18px;width:18px;background:#F44336;border-radius:3px;cursor:pointer;}",".term-recorder.recording .term-recorder-btn{background:#FFC107;}",".term-recorder.recording .term-recorder-size{display:block;}",".term-recorder.recording .term-recorder-duration{display:block;}",".term-header{position:absolute;width:100%;top:0;left:0;right:0;}",".term-footer{position:absolute;width:100%;bottom:0;left:0;right:0;}",".term-resize{position: absolute;right: 0;bottom: 0;width: 20px;height: 20px;cursor: nwse-resize;}",".is-dragging.term-container{opacity:.95};"].join(""),document.head.appendChild(this.$style))}return o(f,[{key:"destroy",value:function(){this.$container.innerHTML="",this.term.constructor.instances.length||document.head.removeChild(this.$style)}}]),f}();var L=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i};var R=function(t){if(Array.isArray(t))return L(t)};var D=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)};var z=function(t,e){if(t){if("string"==typeof t)return L(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(t,e):void 0}};var I=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var M=function(t){return R(t)||D(t)||z(t)||I()},A="input",F="output",B="radio",U="checkbox",H={videoBitsPerSecond:5e6,mimeType:"video/webm"};function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach(function(t){O(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function K(t,e){var s={bools:{},strings:{},unknownFn:null};"function"==typeof(e=e||{}).unknown&&(s.unknownFn=e.unknown),"boolean"==typeof e.boolean&&e.boolean?s.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(t){s.bools[t]=!0});var c={};Object.keys(e.alias||{}).forEach(function(t){c[t]=[].concat(e.alias[t]),c[t].forEach(function(e){c[e]=[t].concat(c[t].filter(function(t){return e!==t}))})}),[].concat(e.string).filter(Boolean).forEach(function(t){s.strings[t]=!0,c[t]&&(s.strings[c[t]]=!0)});var r=e.default||{},a={_:[]};Object.keys(s.bools).forEach(function(t){i(t,void 0!==r[t]&&r[t])});var n=[];function i(t,e,n){if(!n||!s.unknownFn||(i=t,r=n,s.allBools&&/^--[^=]+$/.test(r)||s.strings[i]||s.bools[i]||c[i])||!1!==s.unknownFn(n)){var i,r,o=!s.strings[t]&&Q(e)?Number(e):e;h(a,t.split("."),o),(c[t]||[]).forEach(function(t){h(a,t.split("."),o)})}}function h(t,e,n){for(var i=t,r=0;r<e.length-1;r++){if("__proto__"===(o=e[r]))return;void 0===i[o]&&(i[o]={}),i[o]!==Object.prototype&&i[o]!==Number.prototype&&i[o]!==String.prototype||(i[o]={}),i[o]===Array.prototype&&(i[o]=[]),i=i[o]}var o;"__proto__"!==(o=e[e.length-1])&&(i!==Object.prototype&&i!==Number.prototype&&i!==String.prototype||(i={}),i===Array.prototype&&(i=[]),void 0===i[o]||s.bools[o]||"boolean"==typeof i[o]?i[o]=n:Array.isArray(i[o])?i[o].push(n):i[o]=[i[o],n])}function o(t){return c[t].some(function(t){return s.bools[t]})}-1!==t.indexOf("--")&&(n=t.slice(t.indexOf("--")+1),t=t.slice(0,t.indexOf("--")));for(var u=0;u<t.length;u++){var l=t[u];if(/^--.+=/.test(l)){var d=l.match(/^--([^=]+)=([\s\S]*)$/),f=d[1],p=d[2];s.bools[f]&&(p="false"!==p),i(f,p,l)}else if(/^--no-.+/.test(l)){i(f=l.match(/^--no-(.+)/)[1],!1,l)}else if(/^--.+/.test(l)){f=l.match(/^--(.+)/)[1];void 0===(m=t[u+1])||/^-/.test(m)||s.bools[f]||s.allBools||c[f]&&o(f)?/^(true|false)$/.test(m)?(i(f,"true"===m,l),u++):i(f,!s.strings[f]||"",l):(i(f,m,l),u++)}else if(/^-[^-]+/.test(l)){for(var g=l.slice(1,-1).split(""),y=!1,v=0;v<g.length;v++){var m;if("-"!==(m=l.slice(v+2))){if(/[A-Za-z]/.test(g[v])&&/=/.test(m)){i(g[v],m.split("=")[1],l),y=!0;break}if(/[A-Za-z]/.test(g[v])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(m)){i(g[v],m,l),y=!0;break}if(g[v+1]&&g[v+1].match(/\W/)){i(g[v],l.slice(v+2),l),y=!0;break}i(g[v],!s.strings[g[v]]||"",l)}else i(g[v],m,l)}f=l.slice(-1)[0];y||"-"===f||(!t[u+1]||/^(-|--)[^-]/.test(t[u+1])||s.bools[f]||c[f]&&o(f)?t[u+1]&&/^(true|false)$/.test(t[u+1])?(i(f,"true"===t[u+1],l),u++):i(f,!s.strings[f]||"",l):(i(f,t[u+1],l),u++))}else if(s.unknownFn&&!1===s.unknownFn(l)||a._.push(s.strings._||!Q(l)?l:Number(l)),e.stopEarly){a._.push.apply(a._,t.slice(u+1));break}}return Object.keys(r).forEach(function(e){var t,n,i;t=a,n=e.split("."),i=t,n.slice(0,-1).forEach(function(t){i=i[t]||{}}),n[n.length-1]in i||(h(a,e.split("."),r[e]),(c[e]||[]).forEach(function(t){h(a,t.split("."),r[e])}))}),e["--"]?(a["--"]=new Array,n.forEach(function(t){a["--"].push(t)})):n.forEach(function(t){a._.push(t)}),a}var N=function(){function s(t){var e=this;_(this,s);var n=(this.term=t).options,i=n.pixelRatio,r=n.fontSize,o=n.backgroundColor;this.scrollHeight=0,this.scrollTop=0,this.cursorColor=["#FFF",o],this.cursorSize=5*i,this.logGap=10*i,this.fontSize=r*i,this.btnColor=["#FF5F56","#FFBD2E","#27C93F"],this.btnSize=6*i,this.contentPadding=[45,15,15,15].map(function(t){return t*i}),this.$tmp=document.createElement("div"),this.cacheEmits=[],this.cacheLogs=[],this.renderLogs=[],this.emit=this.emit.bind(this),this.clear=this.clear.bind(this),this.init(),t.on("resize",function(){e.init()}),this.cursor=!1,function t(){var e=this;this.cursorTimer=setTimeout(function(){e.cursor=!e.cursor,e.renderCursor(),t.call(e)},500)}.call(this)}return o(s,[{key:"init",value:function(){var t=this.term,e=t.template.$canvas,n=t.options,i=n.pixelRatio,r=n.fontFamily;this.canvasHeight=e.height,this.canvasWidth=e.width,this.contentHeight=this.canvasHeight-this.contentPadding[0]-this.contentPadding[2],this.contentWidth=this.canvasWidth-this.contentPadding[3],this.maxLength=Math.floor(this.contentHeight/(this.fontSize+this.logGap)),this.ctx=e.getContext("2d"),this.ctx.font="".concat(this.fontSize,"px ").concat(r),this.ctx.textBaseline="top",this.term.emit("size",{header:this.contentPadding[0]/i,content:this.contentHeight/i,footer:this.contentPadding[2]/i}),this.render()}},{key:"render",value:function(t){var e=!(0<arguments.length&&void 0!==t)||t;return this.renderBackground(),this.renderTopbar(),this.renderContent(e),this}},{key:"renderBackground",value:function(){var t=this.term.options.backgroundColor;this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvasWidth,this.canvasHeight)}},{key:"renderTopbar",value:function(){var n=this,t=this.term.options,e=t.title,i=t.fontColor;this.ctx.fillStyle=i;var r=this.ctx.measureText(e).width;this.ctx.fillText(e,this.canvasWidth/2-r/2,this.contentPadding[1]-this.btnSize/2),this.btnColor.forEach(function(t,e){n.ctx.beginPath(),n.ctx.arc(n.contentPadding[3]+n.btnSize+e*n.btnSize*3.6,n.contentPadding[1]+n.btnSize,n.btnSize,0,360,!1),n.ctx.fillStyle=t,n.ctx.fill(),n.ctx.closePath()})}},{key:"renderContent",value:function(t){var e=this.term.options,n=e.pixelRatio,i=e.fontColor;if(this.renderLogs.length)for(var r=0;r<this.renderLogs.length;r+=1){var o=this.renderLogs[r];if(o&&o.length)for(var s=0;s<o.length;s+=1){var c=o[s],a=this.contentPadding[0]+(this.fontSize+this.logGap)*r;c.background&&(this.ctx.fillStyle=c.background,this.ctx.fillRect(c.left,a,c.width,this.fontSize)),this.ctx.fillStyle=c.color||i,this.ctx.fillText(c.text,c.left,a)}}if(this.renderEditable){var h=this.cursorPos,u=h.left,l=h.top;this.term.emit("cursor",{left:u/n,top:l/n})}this.scrollHeight=this.cacheLogs.length*(this.fontSize+this.logGap)/n,this.term.emit("scrollHeight",this.scrollHeight),t&&this.autoScroll()}},{key:"autoScroll",value:function(){var t=this.term.options.pixelRatio,e=this.renderLogs[this.renderLogs.length-1],n=this.cacheLogs.indexOf(e);this.scrollTop=((n+1)*(this.fontSize+this.logGap)-this.contentHeight)/t,this.term.emit("scrollTop",this.scrollTop)}},{key:"renderByIndex",value:function(t){this.renderLogs=this.cacheLogs.slice(t,t+this.maxLength),this.render(!1)}},{key:"renderByTop",value:function(t){var e=this.term.options.pixelRatio,n=Math.ceil(t*e/(this.fontSize+this.logGap));this.renderByIndex(n)}},{key:"renderCursor",value:function(){var t=this.cursorPos,e=t.left,n=t.top;this.renderEditable&&e&&n&&(this.ctx.fillStyle=this.cursor?this.cursorColor[0]:this.cursorColor[1],this.ctx.fillRect(e,n,this.cursorSize,this.fontSize))}},{key:"emit",value:function(t){var e;if(d(t,{type:function(t){return!![A,F].includes(t)||'The type must be "'.concat(A,'" or "').concat(F,'"')},text:"string",prefix:"undefined|string",replace:"undefined|boolean"}),t.replace){this.cacheEmits.pop();var n=this.cacheLogs[this.cacheLogs.length-1];n&&n.group&&(this.cacheLogs=this.cacheLogs.filter(function(t){return t.group!==n.group}))}this.cacheEmits.push(q({},t));var i=this.parse(t);(e=this.cacheLogs).push.apply(e,M(i)),this.renderLogs=this.cacheLogs.slice(-this.maxLength),this.render()}},{key:"parse",value:function(t){var e=this.term.options.prefix;t.type===A&&(t.text=(t.prefix||e)+j(t.text));for(var n=C(),i=[],r=t.text.split(/\r?\n/),o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,s=0,c=this.contentPadding[3],a=0;a<r.length;a+=1){var h=r[a];this.$tmp.innerHTML=h.replace(o,"");for(var u=0;u<this.$tmp.childNodes.length;u+=1){var l=this.$tmp.childNodes[u],d=l.textContent,f=this.ctx.measureText(d).width,p=l.getAttribute?l.getAttribute("color"):"",g=l.getAttribute?l.getAttribute("background"):"",y=c+f;if(y>this.contentWidth){for(var v="",m=!1,b=c,x=M(d),w=0;w<x.length;w+=1){var k=x[w],E=this.ctx.measureText(k).width,P=c+E;if(P<=this.contentWidth)v+=k,c=P;else{var S=q({},t,{width:this.ctx.measureText(v).width,left:m?this.contentPadding[3]:b,text:v,color:p,background:g});i[s]?i[s].push(S):(i[s]=[S],i[s].group=n),s+=1,v=k,m=!0,c=this.contentPadding[3]+E}}var L=q({},t,{width:this.ctx.measureText(v).width,left:this.contentPadding[3],text:v,color:p,background:g});i[s]?i[s].push(L):(i[s]=[L],i[s].group=n)}else{var O=q({},t,{width:f,text:d,left:c,color:p,background:g});i[s]?i[s].push(O):(i[s]=[O],i[s].group=n),c=y}}s+=1,c=this.contentPadding[3]}return i.filter(Boolean)}},{key:"clear",value:function(){this.cacheLogs=[],this.renderLogs=[],this.render()}},{key:"lastCacheLog",get:function(){var t=this.cacheLogs[this.cacheLogs.length-1];return t&&t[t.length-1]}},{key:"lastRenderLog",get:function(){var t=this.renderLogs[this.renderLogs.length-1];return t&&t[t.length-1]}},{key:"cacheEditable",get:function(){return this.term.isFocus&&this.lastCacheLog&&this.lastCacheLog.type===A}},{key:"renderEditable",get:function(){return this.cacheEditable&&this.lastCacheLog===this.lastRenderLog}},{key:"cursorPos",get:function(){if(this.renderEditable){var t=this.term.options.pixelRatio;return{left:this.lastRenderLog.left+this.lastRenderLog.width+4*t,top:this.contentPadding[0]+(this.fontSize+this.logGap)*(this.renderLogs.length-1)}}return{left:0,top:0}}}]),s}();function Q(t){return"number"==typeof t||(/^0x[0-9a-f]+$/i.test(t)||/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(t))}var G=function(){function r(t){var e=this;_(this,r);var n=(this.term=t).drawer,i=t.options.welcome;this.isTyping=!1,this.askResolve=null,this.type=this.type.bind(this),this.input=this.input.bind(this),this.output=this.output.bind(this),this.ask=function(t){return k(!e.isQuestion,"The last problem has not been solved"),e.question(t)},this.output(i).input(""),t.on("input",function(t){n.cacheEditable&&(e.isQuestion?e.question(n.lastCacheLog.prefix,t):e.input(t,!0))}),t.on("enter",function(t){n.cacheEditable&&t.trim()&&(e.isQuestion?(e.askResolve(t),e.askResolve=null):e.execute(t))})}return o(r,[{key:"execute",value:function(t){var i=this;if(!t.trim())return this.input("");var e=this.term.options,n=e.parseOpt,r=e.notFound,o=e.loading,s=this.findAction(t),c=K(t.split(" "),n);if(!s){var a=r.call(this.term,t,c);return this.output(a).input("")}if("function"!=typeof s.output)return this.output(s.output).input("");try{var h=s.output.call(this.term,t,c);if("promise"!==d.kindOf(h))return void 0!==h?this.output(h).input(""):this;var u=o.call(this.term,t,c);return this.output(u),h.then(function(t){return void 0!==t?i.output(t,!0).input(""):i}).catch(function(t){var e="error"===d.kindOf(t)?"".concat(String(t)):"Error: ".concat(String(t)),n='<d color="red">'.concat(e,"</d>");return i.output(n,!0).input("")})}catch(t){var l='<d color="red">'.concat(String(t),"</d>");return this.output(l).input("")}}},{key:"findAction",value:function(n){return n=n.trim().toLowerCase(),this.term.options.actions.find(function(t){var e=d.kindOf(t.input);return"string"===e?n===t.input:"regexp"===e?t.input.test(n):null})}},{key:"output",value:function(t,e){var n=1<arguments.length&&void 0!==e&&e;return this.term.drawer.emit({type:F,replace:n,text:String(t)}),this}},{key:"input",value:function(t,e){var n=1<arguments.length&&void 0!==e&&e;return this.term.drawer.emit({type:A,replace:n,text:String(t)}),this}},{key:"question",value:function(e,t){var n=this,i=1<arguments.length&&void 0!==t?t:"";return this.isQuestion?this.term.drawer.emit({type:A,replace:!0,prefix:e,text:i}):new Promise(function(t){n.askResolve=t,n.term.drawer.emit({type:A,replace:!1,prefix:e,text:i})})}},{key:"type",value:function(t,e){var n=this,s=!(1<arguments.length&&void 0!==e)||e;if(this.isTyping)return Promise.reject();var c=this.term.template.$textarea;return new Promise(function(i){var r=M(t),o="";(function t(){var e=this;if(r.length){this.isTyping=!0;var n=r.shift();o+=n,this.input(o,!0),setTimeout(function(){t.call(e)},100)}else this.isTyping=!1,c.value=o,s&&(this.execute(o),c.value=""),i(o)}).call(n)})}},{key:"isQuestion",get:function(){var t=this.term.drawer,e=t.lastCacheLog;return t.cacheEditable&&e.prefix&&"function"==typeof this.askResolve}}]),r}(),X=function(){function e(t){_(this,e),this.term=t,this.blobs=[]}return o(e,[{key:"start",value:function(){var e=this;k(!this.recording,"The recorder is recording...");var t=this.term.template.$canvas;this.stream=t.captureStream(30),k(this.stream,"Cannot get MediaStream of canvas"),k(MediaRecorder&&MediaRecorder.isTypeSupported(H.mimeType),"Does not support recording webm video"),this.recorder=new MediaRecorder(this.stream,H),this.recorder.ondataavailable=function(t){e.recording&&t.data&&0<t.data.size&&(e.blobs.push(t.data),e.term.emit("recording",{size:e.size,duration:e.duration}))},this.recorder.onstart=function(){e.term.emit("start")},this.recorder.onstop=function(){var t=URL.createObjectURL(new Blob(e.blobs));E(t,"".concat(Date.now(),".webm")),URL.revokeObjectURL(t),e.blobs=[],e.term.emit("end")},this.recorder.start(1e3)}},{key:"end",value:function(){this.recorder.stop()}},{key:"recording",get:function(){return this.recorder&&"recording"===this.recorder.state}},{key:"size",get:function(){return this.blobs.reduce(function(t,e){return t+e.size},0)}},{key:"duration",get:function(){return this.blobs.length}}]),e}(),Y=function(){function t(i){var r=this;_(this,t),this.term=i,this.color="#66d9ef",this.radioTip="(select: Up or Down, confirm: Enter)",this.checkboxTip="(move: Up or Down, select: Space, confirm: Enter)",this.radioInit=!1,this.radioList=[],this.radioKey=null,this.radioResolve=function(){return null},this.checkboxInit=!1,this.checkboxList=[],this.checkboxIndex=0,this.checkboxKey=[],this.checkboxResolve=function(){return null},this.radio=function(t){return r.render(t,B)},this.checkbox=function(t){return r.render(t,U)},i.on("keydown",function(t){var e=i.drawer.lastCacheLog,n=t.keyCode;e.style===B&&r.radioList===e.list&&r.radioEvent(n),e.style===U&&r.checkboxList===e.list&&r.checkboxEvent(n)})}return o(t,[{key:"render",value:function(e,n){var i=this;return new Promise(function(t){d(e,[{key:"string|number",text:"string|number"}]),k(e.length,"Array cannot be empty"),k(e.map(function(t){return t.key}).every(function(t,e,n){return n.indexOf(t)===n.lastIndexOf(t)}),"The key value in the array element must be unique"),n===B&&(i.radioList=e,i.radioKey=e[0].key,i.radioResolve=t,i.radioRender(e,i.radioKey),i.radioInit=!0),n===U&&(i.checkboxList=e,i.checkboxIndex=0,i.checkboxKey=[],i.checkboxResolve=t,i.checkboxRender(),i.checkboxInit=!0)})}},{key:"radioRender",value:function(){var e=this,t=this.radioList.map(function(t){return e.radioKey===t.key?"<d color='".concat(e.color,"'>=> ").concat(t.text,"</d>"):"   ".concat(t.text)}).join("\n");this.term.drawer.emit({text:"".concat(t,"\n").concat(this.radioTip),list:this.radioList,type:F,style:B,replace:this.radioInit})}},{key:"radioEvent",value:function(t){var e=this,n=this.radioList.findIndex(function(t){return t.key===e.radioKey});38===t&&(this.radioKey=n<=0?this.radioList[this.radioList.length-1].key:this.radioList[n-1].key,this.radioRender(this.radioList,this.radioKey)),40===t&&(n===this.radioList.length-1?this.radioKey=this.radioList[0].key:this.radioKey=this.radioList[n+1].key,this.radioRender(this.radioList,this.radioKey)),13===t&&(this.radioResolve(this.radioKey),this.radioInit=!1,this.radioList=[],this.radioKey=null,this.radioResolve=function(){return null})}},{key:"checkboxRender",value:function(){var n=this,t=this.checkboxList.map(function(t,e){return e===n.checkboxIndex?"<d color='".concat(n.color,"'>").concat(n.checkboxKey.includes(t.key)?"◉":"〇"," ").concat(t.text,"</d>"):"".concat(n.checkboxKey.includes(t.key)?"◉":"〇"," ").concat(t.text)}).join("\n");this.term.drawer.emit({text:"".concat(t,"\n").concat(this.checkboxTip),list:this.checkboxList,type:F,style:U,replace:this.checkboxInit})}},{key:"checkboxEvent",value:function(t){if(38===t&&(this.checkboxIndex<=0?this.checkboxIndex=this.checkboxList.length-1:--this.checkboxIndex,this.radioKey=this.checkboxList[this.checkboxIndex].key,this.checkboxRender()),40===t&&(this.checkboxIndex===this.checkboxList.length-1?this.checkboxIndex=0:this.checkboxIndex+=1,this.checkboxRender()),32===t){var e=this.checkboxList[this.checkboxIndex].key,n=this.checkboxKey.indexOf(e);-1<n?this.checkboxKey.splice(n,1):this.checkboxKey.push(e),this.checkboxRender()}13===t&&(this.checkboxResolve(this.checkboxKey),this.checkboxInit=!1,this.checkboxList=[],this.checkboxIndex=0,this.checkboxKey=[],this.checkboxResolve=function(){return null})}}]),t}();function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function V(i){return function(){var t,e=a(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var n=a(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return c(this,t)}}var Z=0,tt=[];return function(){e(i,u);var n=V(i);function i(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return _(this,i),(t=n.call(this)).options=d(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach(function(t){O(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},i.default,{},e),i.scheme),t.isFocus=!1,t.template=new S(r(t)),t.events=new y(r(t)),t.drawer=new N(r(t)),t.commander=new G(r(t)),t.inquirer=new Y(r(t)),t.recorder=new X(r(t)),t.ask=t.commander.ask,t.type=t.commander.type,t.input=t.commander.input,t.output=t.commander.output,t.clear=t.drawer.clear,t.radio=t.inquirer.radio,t.checkbox=t.inquirer.checkbox,t.start=t.recorder.start,t.end=t.recorder.end,Z+=1,t.id=Z,tt.push(r(t)),t}return o(i,null,[{key:"instances",get:function(){return tt}},{key:"version",get:function(){return"1.0.6"}},{key:"utils",get:function(){return P}},{key:"default",get:function(){return{container:"#term",width:600,height:500,actions:[],parseOpt:{},recorder:!0,draggable:!0,dragOpt:{},borderRadius:5,fontSize:13,fontFamily:"Arial",fontColor:"#b0b2b6",title:"Term Web",prefix:'root@linux: ~ <d color="#00f501">$</d> ',welcome:"Last login: ".concat(new Date),loading:function(){return'<d color="yellow">Loading...</d>'},boxShadow:"rgba(0, 0, 0, 0.55) 0px 20px 68px",backgroundColor:"rgb(42, 39, 52)",pixelRatio:window.devicePixelRatio,notFound:function(t){return"-bash: <d color='red'>".concat(t,"</d>: command not found")}}}},{key:"scheme",get:function(){return{container:"string|htmldivelement",width:"number",height:"number",actions:[{input:"string|regexp",output:"string|function"}],parseOpt:"object",recorder:"boolean",draggable:"boolean",dragOpt:"object",borderRadius:"number",fontSize:"number",fontFamily:"string",fontColor:"string",title:"string",prefix:"string",welcome:"string",loading:"function",boxShadow:"string",backgroundColor:"string",pixelRatio:"number",notFound:"function"}}}]),o(i,[{key:"destroy",value:function(){tt.splice(tt.indexOf(this),1),this.events.destroy(),this.template.destroy(),this.emit("destroy")}}]),i}()});
